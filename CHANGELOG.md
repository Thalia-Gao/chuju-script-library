# Changelog

## v1.0.4
- Jscbc: 导航栏仅对 admin 显示“管理后台”，普通用户隐藏
- Jscbc: 新增用户管理 API：`PATCH /api/users/[id]`、`DELETE /api/users/[id]`，含最小管理员保护
- Jscbc: 剧本详情“剧本全文”默认收起，登录后可“展开全文”
- Jscbc: 登录/注册成功后统一跳转首页；注册成功弹窗提示
- Jscbc: 将指定账号提升为管理员权限

## v1.0.3 (Admin improvements & AI fixes)

- Admin 控制台：
  - 新增统计 API `/api/admin/stats`，持久化 `metrics`（浏览量、创作次数）。
  - 控制台“下载次数”改为“剧本创作次数”；新增“刷新数据”按钮（POST action: refresh）。
  - 首页计数浏览量；AI 生成成功后计数创作次数。
- 剧本管理：
  - 改回默认“按标题去重”的列表与总数统计；移除顶部搜索框与批量导入入口。
  - 新增标签行直观筛选，支持 `/api/tags`；分页与筛选联动。
  - 新增“新增剧本”页面；导入子页面与代码已移除。
- 用户管理：
  - 移除虚拟数据，改为使用 `/api/users` 真实数据。
- 系统设置：
  - 数据备份保留，“恢复数据”按钮移除。
- 认证安全：
  - 修复注册时 `admin` 自动提权为管理员的问题，统一为普通用户。
- AI 助手：
  - 接入 SiliconFlow（DeepSeek-V3），新增 `.env.local` 支持；增强错误处理。
  - 支持多轮对话记忆，仅首轮携带标签，后续轮仅发送新增输入。
- 详情页稳定性：
  - 剧本详情页改为直接读取 DB+本地文件，避免 SSR 自身网络请求超时。 